- name: Ensure .claude directory exists
  file:
    path: "{{ claude_config_dir }}"
    state: directory
    mode: 0755

- name: Ensure .claude/plugins directory exists
  file:
    path: "{{ claude_config_dir }}/plugins"
    state: directory
    mode: 0755

- name: Link Claude configuration files
  file:
    src: "{{ dotfiles_home }}/roles/claude/files/{{ item.src }}"
    dest: "{{ claude_config_dir }}/{{ item.dest }}"
    state: link
    force: yes
    mode: "{{ item.mode | default(omit) }}"
  loop:
    - { src: "settings.json", dest: "settings.json" }
    - { src: "statusline-command.sh", dest: "statusline-command.sh", mode: "0755" }
    - { src: "plugins-config.json", dest: "plugins/config.json" }
    - { src: "CLAUDE.md", dest: "CLAUDE.md" }
